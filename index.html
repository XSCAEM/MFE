<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Adobe Destination Selector â€“ MFE Demo</title>

    <!-- Adobe UMD bundle for Asset/Destination Selectors -->
    <script src="https://experience.adobe.com/solutions/CQ-assets-selectors/static-assets/resources/assets-selectors.js"></script>

    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
      }
      .shell {
        display: flex;
        height: 100vh;
      }
      .cms {
        width: 35%;
        border-right: 1px solid #ddd;
        padding: 20px;
        box-sizing: border-box;
        background: #f7f7f7;
      }
      .cms h2 {
        margin-top: 0;
      }
      .cms label {
        font-size: 12px;
        font-weight: bold;
      }
      .cms input {
        width: 100%;
        padding: 6px;
        margin: 4px 0 16px 0;
        box-sizing: border-box;
      }
      .preview-page {
        border: 1px solid #ccc;
        background: #fff;
        padding: 10px;
      }
      .preview-page h3 {
        margin-top: 0;
      }

      .mfe {
        width: 65%;
        padding: 20px;
        box-sizing: border-box;
      }
      .mfe h2 {
        margin-top: 0;
      }
      #destination-selector-container {
        height: calc(100vh - 200px);
        width: 100%;
        border: 1px solid #ddd;
        box-sizing: border-box;
      }
      pre {
        margin-top: 10px;
        padding: 10px;
        border: 1px solid #ddd;
        background: #fafafa;
        font-size: 11px;
        max-height: 200px;
        overflow: auto;
      }
    </style>
  </head>

  <body>
    <div class="shell">
      <!-- Fake CMS pane (left) -->
      <div class="cms">
        <h2>Fake CMS Editor (Sitecore-like)</h2>

        <label>Page Title</label>
        <input id="titleInput"
               placeholder="Summer in Europe"
               oninput="
                 document.getElementById('pageTitle').textContent =
                   this.value || 'Page Title';
               ">

        <label>Chosen AEM Folder Path</label>
        <input id="pathInput"
               placeholder="Will be filled from Destination Selector"
               readonly />

        <h3>Page Preview</h3>
        <div class="preview-page">
          <h3 id="pageTitle">Page Title</h3>
          <p style='font-size: 12px; color:#555;'>
            Content here is authored in Sitecore, while assets/folders
            come from AEM via the embedded Adobe micro frontend.
          </p>
          <p id="folderPreview"
             style='font-size: 11px; color:#777; word-break: break-all;'>
            Selected folder: (none yet)
          </p>
        </div>
      </div>

      <!-- Real Adobe MFE pane (right) -->
      <div class="mfe">
        <h2>Adobe Destination Selector (Real Micro Frontend)</h2>
        <p style="font-size: 13px;">
          This is the official Adobe Destination Selector MFE from AEM as a
          Cloud Service, embedded via vanilla JavaScript. In a Sitecore
          integration, this panel would live inside the editor and let authors
          choose an AEM folder to upload into.
        </p>

        <div id="destination-selector-container"></div>

        <pre id="selectionOutput">// Selected destination JSON will appear here</pre>
      </div>
    </div>

    <script>
      // Wait for DOM + UMD script
      window.addEventListener('load', () => {
        const container = document.getElementById('destination-selector-container');
        const output = document.getElementById('selectionOutput');
        const pathInput = document.getElementById('pathInput');
        const folderPreview = document.getElementById('folderPreview');

        // TODO: replace these three with your real values
        const destinationSelectorProps = {
          imsOrg: "YOUR_IMS_ORG@AdobeOrg",             // e.g. 1234567890ABCDEF@AdobeOrg
          imsToken: "YOUR_IMS_BEARER_TOKEN_HERE",      // from existing session / OAuth
          apiKey: "YOUR_API_KEY_HERE",                 // client_id from Adobe Developer Console

          rootPath: "/content/dam",                    // where to start browsing

          // Called when user confirms a folder / destination
          handleSelection: (selection) => {
            // selection is an array of SelectedDestination objects
            output.textContent = JSON.stringify(selection, null, 2);

            if (Array.isArray(selection) && selection.length > 0) {
              const first = selection[0];
              const path = first["repo:path"] || "(no path)";

              pathInput.value = path;
              folderPreview.textContent = "Selected folder: " + path;
            }
          }
        };

        // Render the real Adobe Destination Selector MFE
        PureJSSelectors.renderDestinationSelector(container, destinationSelectorProps);
      });
    </script>
  </body>
</html>
